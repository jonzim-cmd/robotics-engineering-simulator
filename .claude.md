# Project ARES: Engineering Simulator - Claude Development Guidelines

## Projekt-Übersicht
Ein interaktives Lernspiel für Schüler, das technische Konzepte (Mechanik, Elektronik, Signalverarbeitung) durch narrative Simulationen vermittelt.

## Wichtige Entwicklungsprinzipien

### 1. Event Tracking & Analytics
**KRITISCH:** Bei jeder neuen Funktion muss Event-Tracking implementiert werden!

- Nutze die `trackEvent()` Funktion aus `src/app/actions.ts`
- Tracke wichtige User-Aktionen:
  - Level-Starts und Completions
  - Reflektionen und Antworten
  - Interaktionen (Button-Klicks, Auswahlen, Simulationen)
  - Fehler und Erfolge

**Beispiel:**
```typescript
// Bei Level-Start
await trackEvent(userId, levelId, 'LEVEL_START', { timestamp: new Date() });

// Bei User-Interaktion
await trackEvent(userId, levelId, 'MATERIAL_SELECTED', {
  material: 'aluminium',
  reason: 'optimal weight-to-stiffness ratio'
});

// Bei Level-Completion
await trackEvent(userId, levelId, 'LEVEL_COMPLETE', {
  attempts: 3,
  duration: 245 // seconds
});
```

### 2. Navigation & Zurück-Logik
**WICHTIG:** Implementiere immer klare Navigation, um zum vorherigen Zustand zurückzukehren!

- Füge "Zurück"-Buttons in neue Seiten/Komponenten ein
- Nutze React State oder URL-Parameter für State-Management
- Stelle sicher, dass User nie "gefangen" sind

**Beispiel:**
```typescript
// Im Header/Footer einer Komponente
<button onClick={() => router.push('/')}>
  <ArrowLeft /> Zurück
</button>

// Oder mit State
const [view, setView] = useState('main');
// ... später
<button onClick={() => setView('main')}>Zurück</button>
```

### 3. Admin Portal Patterns
- Event Logs sollten `renderEventPayload()` nutzen für saubere Darstellung
- Filterfunktionen für große Datensätze implementieren
- Bestätigungsdialoge bei destruktiven Aktionen (Löschen)
- Loading States während asynchroner Operationen

### 4. UI/UX Guidelines
- **Design:** Dark Mode, Monospace für technische Daten, Cyan für Erfolg, Rot für Fehler
- **Accessibility:** Tooltips für Fachbegriffe, klare Fehlermeldungen
- **Responsiveness:** Mobile-first, aber Desktop-optimiert für komplexe Simulationen
- **Performance:** Lazy Loading für Level-Komponenten

### 5. Code-Struktur
```
/src
  /app
    page.tsx          # Level Loader
    actions.ts        # Server Actions (DB, Tracking)
  /components
    /levels           # Isolierte Level-Dateien
    /ui               # Wiederverwendbare UI-Komponenten
```

### 6. Datenbank-Konventionen
- `users` Tabelle: Schüler-Accounts
- `progress` Tabelle: Event-Tracking mit JSONB payload
- `ON DELETE CASCADE` für referenzielle Integrität
- Immer `last_active` Timestamp aktualisieren

### 7. Neue Features Checkliste
Beim Implementieren neuer Features:
- [ ] Event-Tracking hinzufügen
- [ ] Navigation/Zurück-Button implementieren
- [ ] Error Handling & User Feedback
- [ ] Loading States
- [ ] Mobile Responsiveness testen
- [ ] Tooltips für neue Fachbegriffe
- [ ] Admin Portal Sichtbarkeit (falls relevant)

## Wichtige Dateien
- `src/app/actions.ts` - Server Actions (Login, Tracking, Admin)
- `src/app/admin/page.tsx` - Admin Portal für Lehrer
- `src/lib/db-init.ts` - Datenbank Schema
- `robotk.md` - Detaillierter Projekt-Masterplan

## Technologie-Stack
- **Framework:** Next.js 14 (App Router)
- **Database:** Vercel Postgres (@vercel/postgres)
- **Styling:** Tailwind CSS
- **Animations:** Framer Motion
- **Charts:** Recharts
- **Icons:** lucide-react
- **State:** Zustand (für globalen State)

## Storytelling & Didaktik
- Jedes Level erzählt eine zusammenhängende Geschichte
- Fachbegriffe werden immer im Kontext erklärt (Glossary-Ansatz)
- "Jargon-Busting": Keine Begriffe ohne sofortige Erklärung
- Fail States mit lehrreichem Feedback, nicht nur "Falsch"
